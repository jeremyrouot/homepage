<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>TP Editeur de notes</title>

	<meta name="author" content="Guillaume CLODIC">

	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/custom-bootstrap.css">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

</head>

<body id="page-top">

	<!-- Navigation -->
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
		<div class="container">
			<a class="navbar-brand js-scroll-trigger" href="index.html#page-top">Introduction aux technologies WEB</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive"
			 aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<!--			<div class="collapse navbar-collapse" id="navbarResponsive">
						<ul class="navbar-nav ml-auto">
							<li class="nav-item">
								<a class="nav-link js-scroll-trigger" href="#about">About</a>
							</li>
							<li class="nav-item">
								<a class="nav-link js-scroll-trigger" href="#services">Services</a>
							</li>
							<li class="nav-item">
								<a class="nav-link js-scroll-trigger" href="#contact">Contact</a>
							</li>
						</ul>
					</div> -->
		</div>
	</nav>

	<section>
		<div class="container">

			<h1>TP Editeur de notes</h1>

			<p>
				Le but du TP va √™tre de cr√©er un √©diteur de notes en HTML. Un peu comme <a href="https://framablog.org/2016/10/04/framanotes-vos-notes-vous-appartiennent-for-ever/">√ßa</a> mais en un peu plus simple.
			</p>

            <p>
                Tous les √©lements de style donn√© dans le TP sont donn√©s √† titre indicatif. Si vous pouvez faire mieux n'h√©sitez pas !
            </p>

            <h2>1 - Corps de notre page HTML</h2>

            <p>
                Nous allons cr√©er une page HTML vide <code>notes.html</code> li√© √† un fichier CSS <code>notes.css</code> et √† un fichier javascript <code>notes.js</code>. Pour l'instant le fichier CSS et le fichier javascript sont vides.
            </p>

            <p>
                Notre page HTML va se d√©conposer en deux parties :
            </p>

            <ul>
                <li>Une partie haute contenant le texte "üìù Notes" sous forme de titre. Ce bloc est une balise <code> &lt;header&gt;</code> contenant une balise <code> &lt;h1&gt;</code>.</li>
                <li>Une partie principale contenue dans une balise <code>&lt;section&gt;</code>.</li>
            </ul>

            <p>La partie haute a un bord bas gris de 1px d'√©paisseur.</p>

            <p>La partie principale va se composer en deux blocs (<code>&lt;div&gt;</code>).</p>

            <ul>
                <li>Un premier bloc qui contient la partie cr√©ation de notes et a pour identifiant <code>creation</code>.</li>
                <li>Un second bloc qui contient la liste des notes cr√©√©es et a pour identifiant <code>notes</code>.</li>
            </ul>

            <p>
                <strong>Cr√©er les diff√©rents fichiers et compl√©ter le fichier HTML.</strong>
            </p>

            <h2>2 -  Cr√©ation de notes</h2>

            <h3>Partie HTML</h3>

            <p>Dans le bloc "cr√©ation de notes", on va ajouter une balise <code>&lt;div&gt;</code> ayant pour id <code>new-note</code>.</p>

            <p>Cette balise contient trois sous-balises <code>&lt;div&gt;</code> : </p>
            
            <ul>
                <li>La premi√®re a pour id <code>title</code> et pour contenu "Titre".</li>
                <li>La seconde a pour id <code>content</code> et pour contenu "Corps".</li>
                <li>La derni√®re contient un bouton pour ajouter la note √† la liste des notes (on peut utiliser le symbole "+" comme texte du bouton).</li>
            </ul>

            <p>Les deux premiers <code>div</code> ont leur contenu "√©ditable" grace √† l'attribut <code>contenteditable</code>.</p>

            <p>Les balises sont styl√©es de la mani√®re suivante :</p>

            <ul>
                <li>La balise <code>div</code> ayant pour id <code>creation</code> a un <code>padding</code> de 10px.</li>
                <li>La balise <code>div</code> ayant pour id <code>new-note</code> occupe 30% de la page et est centr√©e. Elle a √©galement un <code>padding</code> de 10px.</li>
            </ul>

            <p>
                La balise ayant pour id <code>new-note</code> doit √©galement avoir une classe <code>note</code>. Cette classe va nous permettre de d√©finir le style standard d'une note i.e. :
            </p>

            <ul>
                <li>Un <code>padding</code> de 10px.</li>
                <li>Un <code>margin</code> de 10px.</li>
                <li>Un fond jaune.</li>
                <li>Un bord de 2px en d√©grad√© de gris (pour un effet 3D).</li>
            </ul>

            <p>
                <strong>
                    Compl√©ter votre page en fonction de ces nouveaux √©l√©ments.
                </strong>
            </p>

            <h3>Partie javascript</h3>
            
            <p>On utilise un tableau stock√© sous forme de variable globale <code>notesArray</code> pour stocker nos "notes". On initialise cette variable √† un tableau vide au d√©part.</p>

            <p>Lorsque l'on va cliquer sur le bouton "Ajouter" la fonction <code>addNote</code> va √™tre appel√©e. Cette fonction r√©alise les actions suivantes : </p>

            <ul>
                <li>R√©cup√®re le contenu texte de la balise ayant pour id <code>title</code> dans une variable locale.</li>
                <li>R√©cup√®re le contenu HTML de la balise ayant pour id <code>content</code> dans une variable locale.</li>
                <li>Cr√©e un objet "note" avec ces √©l√©ments.</li>
                <li>Ajoute cet objet "note" au tableau <code>notesArray</code>.</li>
            </ul>

            <p>On peut cr√©er un objet "note" de la mani√®re suivante :</p>

			<pre><code class="javascript">
var note = {};
note.title = ...titre...;
note.content = ...contenu...;
            </code></pre>
                    
            <p>
                <strong>
                    Compl√©ter votre page en fonction de ces nouveaux √©l√©ments et v√©rifier que le bouton "Ajouter" fonctionne (i.e. que le tableau croit bien).
                </strong>
            </p>

            <h2>3 - Liste de notes</h2>
    
            <h3>Partie HTML</h3>

            <p>
                On va cr√©er dans le HTML un mod√®le pour repr√©senter notre note. C'est une balise <code>div</code> qui a pour identifiant <code>model</code>. Elle contient trois sous-balises <code>div</code>
            </p>

            <ul>
                <li>Une premi√®re balise qui contient le titre de la note.</li>
                <li>Une seconde balise qui contient le contenu de la note.</li>
                <li>Une derni√®re balise contenant un bouton permettant de supprimer la note (on peut utiliser le symbole "üóë").</li>
            </ul>

            <p>Cette balise a √©videment pour classe <code>note</code> qui est notre classe g√©n√©rique pour une note.</p>

            <p>Cette balise mod√®le est cach√© √† l'utilisateur.</p>

            <p>
                <strong>
                    Compl√©ter votre page en fonction de ces nouveaux √©l√©ments.
                </strong>
            </p>

            <h3>Partie Javascript</h3>

            <p>La liste des notes va se trouver dans la balise <code>div</code> ayant pour id <code>notes</code>. Chaque note aura la m√™me structure que notre mod√®le d√©finit pr√©c√©dement.</p>

            <p>Nous allons √©crire la fonction <code>updateNotes()</code> qui va mettre √† jour la liste des notes.</p>

            <p>Cette fonction efface les notes existentes dans la page web (donc vide la balise correspondante). Puis elle parcourt le tableau des "notes" et pour chaque √©l√©ment r√©alise les actions suivantes :</p>

            <ul>
                <li>Clone notre balise ayant pour identifiant <code>model</code> avec la fonction <code>cloneNode(true)</code></li>
                <li>Sur cette √©l√©ment clon√©, supprime son attribut <code>id</code>, met √† jour la balise "titre" et la balise "contenu" avec les √©lements du tableau <code>notesArray</code> (attention pour la balise contenu c'est tout le contenu HTML que l'on met √† jour).</li>
                <li>Ajoute notre √©l√©ment √† la balise ayant pour identifiant <code>notes</code>.</li>
            </ul>

            <p>La fonction <code>updateNotes()</code> doit √™tre appeler au chargement de la page et √† la fin de la fonction <code>addNote()</code></p>

            <p>
                <strong>
                    Compl√©ter et tester votre page en fonction de ces nouveaux √©l√©ments.
                </strong>
            </p>

            <h3>Partie CSS</h3>

            <p>La balise qui contient les notes occupe 70% de la largeur, elle affiche les notes sur 3 colonnes et a un <code>padding</code> de 10px.</p>

            <p>Avec l'affichage sur 3 colonnes certaines notes sont parfois coup√©es en deux (une partie en bas une partie en haut). Modifier la classe <code>note</code> pour que ce ne soit plus le cas.</p>

            <p>Ajouter un style au titre des notes pour qu'ils soient distinguable du contenu.</p>            

            <p>
                <strong>
                    Compl√©ter votre page en fonction de ces nouveaux √©l√©ments.
                </strong>
            </p>

            <h2>Partie 4 - Un peu d'AJAX</h2>

            <h3>Documentation de l'api</h3>

            <style>
                table {
                border-collapse: collapse;
                }

                table, th, td {
                    border: 1px solid black;
                    padding: 5px;
                }
           </style>


            <table>
                <tr>
                    <th>API</th>
                    <th>M√©thode</th>
                    <th>Type</th>
                    <th>Param√®tres</th>
                    <th>R√©sultat</th>
                </tr>
                <tr>
                    <td><code>http://172.31.3.11/notes</code></td>
                    <td><code>POST</code></td>
                    <td><code>aucun</code></td>
                    <td><code>aucun</code></td>
                    <td>R√©cup√®re un tableau avec toutes les notes</td>
                </tr>
                <tr>
                    <td><code>http://172.31.3.11/notes</code></td>
                    <td><code>POST</code></td>
                    <td><code>JSON</code></td>
                    <td><code>title</code>, <code>content</code>, <code>style</code></td>
                    <td>Ajoute une note sur le serveur</td>
                </tr>
                <tr>
                    <td><code>http://172.31.3.11/deletenotes</code></td>
                    <td><code>POST</code></td>
                    <td><code>JSON</code></td>
                    <td><code>identifier</code></td>
                    <td>Supprime une note sur le serveur</td>
                </tr>
            </table>

            <p>La fonction <code>addNote()</code> envoie la note vers le serveur (avant l'appel √† la fonction <code>updateNotes()</code>.</p>

            <p>La fonction <code>updateNotes()</code> r√©cup√®re l'ensemble des messages depuis le serveur pour les afficher.</p>

            <p>La fonction <code>updateNotes()</code> est appel√© toutes les 30 secondes pour mettre √† jour les notes en fonction du contenu pr√©sent sur le serveur.</p>

            <p>
                <strong>Modifier le code javascript pour impl√©menter le dialogue avec le serveur.</strong>
            </p>

            <h2>Partie 5 - Un peu plus de CSS</h2>

            <p>On utilise une fonte externe de votre choix pour rendre la page plus jolie.</p>

            <p>Le style des boutons doit √™tre le suivant : </p>

            <ul>
                <li>Par d√©faut pas de bord et un fond transparent.</li>
                <li>Lorsque l'on survole le bouton, pas de bord non plus mais un fond gris avec une opacit√© de 0,5.</li>
                <li>Le bouton doit √™tre en bas √† droite de la note.
            </ul>
            
            <p>La page doit √™tre r√©active, la balise d'ajout de notes et les balises notes doivent avoir une largeur minimum.</p>

            <p>
                <strong>
                    Compl√©ter votre page en fonction de ces nouveaux √©l√©ments.
                </strong>
            </p>

            <h2>Partie 6 - Suppression d'une note</h2>

            <p>
                Dans l'objet <code>note</code> retourn√© par le serveur se trouve en plus des propri√©t√©s <code>title</code>,
                <code>content</code>, <code>style</code> la propri√©t√© <code>identifier</code> qui identifie de mani√®re unique cette note.
            </p>

            <p>
                Dans la fonction <code>updateNotes()</code> lors de la cr√©ation d'une nouvelle note, ajouter un attribut 
                <code>identifier</code> ayant pour valeur la propri√©t√© <code>identifier</code> √† l'√©lement DOM repr√©sentant la note.
            </p>

            <p>
                Lorsque l'on clique sur le bouton "Supression" d'une note. Appeler la fonction <code>deleteNote</code> avec l'argument <code>this</code>.
            </p>

            <p>
                La fonction <code>deleteNode</code> est donc appel√©e avec pour argument l'objet DOM repr√©sentant le bouton. 
                En s'aidant de la propri√©t√© <code>parentElement</code> on r√©cup√®re l'√©l√©ment parent ayant l'attribut <code>identifier</code>
                Avec cet identiant on appelle le serveur pour supprimer la note correspondante puis on met √† jour la liste des notes.
            </p>

            <p>
                <strong>Modifier le code javascript pour impl√©menter le dialogue avec le serveur.</strong>
            </p>

            <h2>Partie 7 - Date des notes</h2>

            <p>
                Dans l'objet "note" retourn√© par le serveur se trouve une prori√©t√© <code>date_time</code>. 
                Cette propri√©t√© repr√©sente la date de cr√©ation de la note sur le serveur exprim√©e 
                en millisecondes √©coul√©es depuis le premier janvier 1970 √† minuit UTC.
            </p>

            <p>
                Pour transformer la date de cr√©ation exprim√©e en millisecondes en objet <code>Date</code>,
                on utilise <code>new Date(...temps en millisecondes);</code>.
            </p>

            <p>
                On va afficher cette date en popup par dessus la note. Pour cela, dans la fonction <code>updateNotes()</code> 
                on va ajouter √† la balise repr√©sentant la note un attribut <code>title</code> avec la date sous forme textuelle.
            </p>

            <p>
                Pour transformer la date en texte on utilise les fonctions <code>toLocaleDateString()</code> et <code>toLocaleTimeString()</code> sur l'objet <code>Date</code>.
            </p>
            
            <p>
                <strong>
                    Compl√©ter votre page en fonction de ces nouveaux √©l√©ments.
                </strong>
            </p>

            <h2>Partie 8 - Horloge</h2>

            <p>La page comporte une horloge en haut √† droite (dans la barre d'en haut). Cette horloge affiche la date et l'heure. L'horloge est mise √† jour toutes les secondes.</p>

            <p>Pour obtenir l'objet <code>Date</code> de la date courante on utilise <code>new Date();</code>.</p>

            <p>Pour l'affichage de l'horloge, le texte de la date est l√©g√®rement plus petit que celui de l'heure.</p>

            <p>
                <strong>
                    Compl√©ter votre page en fonction de ces nouveaux √©l√©ments.
                </strong>
            </p>

            <h2>Partie 9 - Couleur des notes</h2>

            <p>On va permettre √† l'utilisateur de donner une couleur √† ses notes.</p>

            <p>A c√¥t√© du bouton "Ajouter" on va accoler 4 nouveaux boutons.</p>

            <p>Chaque bouton a pour texte un simple disque : "‚¨§" avec une classe permettant de d√©finir la couleur du disque :</p>

            <ul>
                <li>classe <code>yellow</code> avec couleur <code>yellow</code></li>
                <li>classe <code>green</code> avec couleur <code>green</code></li>
                <li>classe <code>blue</code> avec couleur <code>blue</code></li>
                <li>classe <code>pink</code> avec couleur <code>pink</code></li>
            </ul>

            <p>On d√©finit √©galement de nouveaux s√©lecteurs</p>

            <ul>
                <li>Un √©l√©ment ayant pour classe <code>note</code> et <code>yellow</code></li> aura pour couleur de fond : <code>lightyellow</code>.
                <li>Un √©l√©ment ayant pour classe <code>note</code> et <code>green</code></li> aura pour couleur de fond : <code>lightgreen</code>.
                <li>Un √©l√©ment ayant pour classe <code>note</code> et <code>blue</code></li> aura pour couleur de fond : <code>lightblue</code>.
                <li>Un √©l√©ment ayant pour classe <code>note</code> et <code>pink</code></li> aura pour couleur de fond : <code>lightpink</code>.
            </ul>

            <p>Lorsque l'on clique sur un bouton, la fonction <code>changeColor</code> est appel√© avec l'argument <code>this</code>. Elle r√©alise les op√©rations suivantes :</p>

            <ul>
                <li>R√©cup√®re la classe de l'√©l√©ment pass√© en argument (<code>yellow</code>, <code>green</code>, ...).</li>
                <li>
                    Sur l'√©l√©ment ayant pour identifiant <code>new-note</code> supprime les classes 
                    <code>yellow</code>, <code>green</code>, <code>blue</code>, <code>pink</code> (<code>elm.classList.remove()</code>).
                </li>
                <li>
                    Ajoute la classe r√©cup√©r√©e √† cet √©l√©ment (<code>yellow</code>, <code>green</code>, ...).
                </li>
            </ul>

            <p>
                Dans la fonction <code>addNote()</code> il faut rajouter dans les propri√©t√©s de l'objet "note" envoy√© 
                au serveur une propri√©t√© <code>style</code> qui aura pour valeur la classe de la couleur associ√©e (<code>yellow</code>, <code>green</code>, ...).
            </p>

            <p>
                Dans la fonction <code>updateNotes()</code>, on tiendra compte de la propri√©t√© <code>style</code> de l'objet "note"
                renvoy√© par le serveur pour d√©finir la couleur de la note.
            </p>

            <p>
                <strong>
                    Compl√©ter votre page en fonction de ces nouveaux √©l√©ments.
                </strong>
            </p>
    
            <h2>Partie 10 - Choix de couleurs dans un popup</h2>

            <p>On va placer les 4 boutons de couleurs dans un menu popup. Pour le bouton du menu on utilise l'ic√¥ne "üé®"</p>

            <p>Pour le menu popup on s'inspire de l'exemple suivant : <a href="https://www.w3schools.com/css/css_dropdowns.asp">CSS Dropdowns</a>.</p>

            <p>Dans le menu on retrouve les 4 boutons de couleurs.</p>
            
            <p>
                <strong>
                    Compl√©ter votre page en fonction de ces nouveaux √©l√©ments.
                </strong>
            </p>
        
            <h2>Partie 11 - Imitation du placeholder</h2>

            <p>
                Dans la partie √©dition d'une nouvelle note, 
                on veut avoir un comportement similaire √† la propri√©t√© <code>placeholder</code> d'un <code>input</code>
                de type <code>text</code> (voir un exemple <a href="https://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_input_placeholder">ici</a>).
            </p>

            <p>
                On peut s'inspirer de la technique d√©crite ici : <a href="https://codepen.io/flesler/pen/AEIFc">Placeholder support for contentEditable elements, without JavaScript</a>.
            </p>

            <p>
                <strong>
                    Compl√©ter votre page en fonction de ces nouveaux √©l√©ments.
                </strong>
            </p>
    
    

		</div>
	</section>

	<script src="js/jquery-3.2.1.slim.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
</body>

</html>

